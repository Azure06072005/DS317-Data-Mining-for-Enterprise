{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/trakiet/dualeo?scriptVersionId=282098945\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"code","execution_count":1,"id":"981bf7de","metadata":{"_cell_guid":"b1076dfc-b9ad-4769-8c92-a6c4dae69d19","_uuid":"8f2839f25d086af736a60e9eeb907d3b93b6e0e5","execution":{"iopub.execute_input":"2025-11-27T04:16:05.037973Z","iopub.status.busy":"2025-11-27T04:16:05.03743Z","iopub.status.idle":"2025-11-27T04:16:06.444442Z","shell.execute_reply":"2025-11-27T04:16:06.443731Z"},"papermill":{"duration":1.412899,"end_time":"2025-11-27T04:16:06.446188","exception":false,"start_time":"2025-11-27T04:16:05.033289","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["/kaggle/input/ds317-user-course/.part-00002-1234f2cd-53a0-4516-89d1-200a7723379f-c000.snappy.parquet.crc\n","/kaggle/input/ds317-user-course/part-00001-1234f2cd-53a0-4516-89d1-200a7723379f-c000.snappy.parquet\n","/kaggle/input/ds317-user-course/.part-00001-1234f2cd-53a0-4516-89d1-200a7723379f-c000.snappy.parquet.crc\n","/kaggle/input/ds317-user-course/.part-00000-1234f2cd-53a0-4516-89d1-200a7723379f-c000.snappy.parquet.crc\n","/kaggle/input/ds317-user-course/._SUCCESS.crc\n","/kaggle/input/ds317-user-course/part-00000-1234f2cd-53a0-4516-89d1-200a7723379f-c000.snappy.parquet\n","/kaggle/input/ds317-user-course/part-00003-1234f2cd-53a0-4516-89d1-200a7723379f-c000.snappy.parquet\n","/kaggle/input/ds317-user-course/part-00002-1234f2cd-53a0-4516-89d1-200a7723379f-c000.snappy.parquet\n","/kaggle/input/ds317-user-course/_SUCCESS\n","/kaggle/input/ds317-user-course/.part-00003-1234f2cd-53a0-4516-89d1-200a7723379f-c000.snappy.parquet.crc\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00064-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00010-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00088-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00165-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00178-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00149-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00190-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00153-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00180-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00091-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00191-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00120-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00046-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00141-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00054-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00108-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00016-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00101-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00145-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00040-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00110-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00020-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00003-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00066-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00134-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00006-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00199-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00061-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00151-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00130-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00026-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00024-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00033-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00019-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00164-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00116-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00123-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00182-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00169-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00189-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00111-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00152-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00171-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00080-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00096-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00109-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00125-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00098-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00135-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00139-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00044-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00119-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00177-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00181-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00148-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00115-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00079-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00168-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00155-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00193-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00114-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00053-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00077-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00027-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00104-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00034-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00198-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00124-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00131-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00126-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00039-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00063-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00002-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00147-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00103-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00076-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00157-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00081-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00107-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00042-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00173-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00047-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00021-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00090-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00014-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00060-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00015-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00162-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00073-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00187-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00158-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00144-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00118-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00137-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00099-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00195-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00117-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00032-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00138-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00094-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00051-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00065-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00023-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00097-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00025-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00089-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00062-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00121-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00113-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00128-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00167-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00005-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00133-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00170-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00045-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00084-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00102-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00004-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00001-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00007-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00174-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00067-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00093-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00069-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00011-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00049-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00179-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00150-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00197-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00129-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00078-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00068-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00146-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00176-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00058-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00018-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00194-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00106-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00188-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00143-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00127-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00142-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00071-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00132-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00070-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00028-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00056-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00000-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00037-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00029-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00184-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00086-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00186-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00154-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00048-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00059-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00022-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00100-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00192-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00196-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00175-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00136-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00156-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00095-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00092-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00160-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00112-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00041-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00085-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00055-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00050-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00140-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00183-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00031-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00172-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00163-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00122-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00057-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00012-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00043-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00075-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00159-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00008-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00013-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00083-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00166-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00009-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00036-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00017-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00038-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00030-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00035-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00185-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00161-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/_SUCCESS\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00072-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00082-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00105-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00087-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00074-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00052-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_user_video_final.parquet/part-00004-be584545-8204-4005-9a41-89ee3dea23bc-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_user_video_final.parquet/part-00002-be584545-8204-4005-9a41-89ee3dea23bc-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_user_video_final.parquet/part-00007-be584545-8204-4005-9a41-89ee3dea23bc-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_user_video_final.parquet/part-00003-be584545-8204-4005-9a41-89ee3dea23bc-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_user_video_final.parquet/part-00006-be584545-8204-4005-9a41-89ee3dea23bc-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_user_video_final.parquet/part-00000-be584545-8204-4005-9a41-89ee3dea23bc-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_user_video_final.parquet/part-00005-be584545-8204-4005-9a41-89ee3dea23bc-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_user_video_final.parquet/_SUCCESS\n","/kaggle/input/user-video-final/df_user_video_final.parquet/part-00001-be584545-8204-4005-9a41-89ee3dea23bc-c000.snappy.parquet\n"]}],"source":["# This Python 3 environment comes with many helpful analytics libraries installed\n","# It is defined by the kaggle/python Docker image: https://github.com/kaggle/docker-python\n","# For example, here's several helpful packages to load\n","\n","import numpy as np # linear algebra\n","import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)\n","\n","# Input data files are available in the read-only \"../input/\" directory\n","# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n","\n","import os\n","for dirname, _, filenames in os.walk('/kaggle/input'):\n","    for filename in filenames:\n","        print(os.path.join(dirname, filename))\n","\n","# You can write up to 20GB to the current directory (/kaggle/working/) that gets preserved as output when you create a version using \"Save & Run All\" \n","# You can also write temporary files to /kaggle/temp/, but they won't be saved outside of the current session"]},{"cell_type":"code","execution_count":2,"id":"6a6cc17c","metadata":{"execution":{"iopub.execute_input":"2025-11-27T04:16:06.45387Z","iopub.status.busy":"2025-11-27T04:16:06.453302Z","iopub.status.idle":"2025-11-27T04:16:06.456547Z","shell.execute_reply":"2025-11-27T04:16:06.456052Z"},"papermill":{"duration":0.007616,"end_time":"2025-11-27T04:16:06.457489","exception":false,"start_time":"2025-11-27T04:16:06.449873","status":"completed"},"tags":[]},"outputs":[],"source":["df_user_video_final_path = '/kaggle/input/user-video-final/df_user_video_final.parquet'\n","df_user_course_grouped_path = '/kaggle/input/ds317-user-course'"]},{"cell_type":"code","execution_count":3,"id":"16cbab40","metadata":{"execution":{"iopub.execute_input":"2025-11-27T04:16:06.464104Z","iopub.status.busy":"2025-11-27T04:16:06.4636Z","iopub.status.idle":"2025-11-27T04:16:13.535914Z","shell.execute_reply":"2025-11-27T04:16:13.5352Z"},"papermill":{"duration":7.076932,"end_time":"2025-11-27T04:16:13.537258","exception":false,"start_time":"2025-11-27T04:16:06.460326","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["Setting default log level to \"WARN\".\n","To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).\n","25/11/27 04:16:11 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\n"]}],"source":["import pyspark\n","from pyspark.sql import SparkSession\n","import warnings\n","from pyspark.sql.types import *\n","from pyspark.sql import functions as F\n","from pyspark.sql.types import IntegerType\n","import seaborn as sns\n","import matplotlib.pyplot as plt\n","from os import truncate\n","from pyspark.sql.functions import explode, col, sum, from_unixtime, hour, dayofweek, count, round, when, isnull, split, avg, regexp_replace\n","warnings.filterwarnings(\"ignore\")\n","\n","spark = SparkSession.builder \\\n","  .appName(\"reply_user_video_analysis\") \\\n","  .master(\"local[*]\") \\\n","  .config(\"spark.some.config.option\", \"some-value\") \\\n","  .getOrCreate()"]},{"cell_type":"code","execution_count":4,"id":"f6906e7b","metadata":{"execution":{"iopub.execute_input":"2025-11-27T04:16:13.545023Z","iopub.status.busy":"2025-11-27T04:16:13.544304Z","iopub.status.idle":"2025-11-27T04:16:17.537505Z","shell.execute_reply":"2025-11-27T04:16:17.536574Z"},"papermill":{"duration":3.999045,"end_time":"2025-11-27T04:16:17.539614","exception":false,"start_time":"2025-11-27T04:16:13.540569","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["                                                                                \r"]}],"source":["# Đọc toàn bộ folder (tự động load tất cả part-*.parquet)\n","df_user_video_final = spark.read.parquet(df_user_video_final_path)\n","# df_with_stats_fixed = spark.read.parquet(df_with_stats_fixed_path)\n","df_user_course_grouped = spark.read.parquet(df_user_course_grouped_path, header=True, inferSchema=True)"]},{"cell_type":"code","execution_count":5,"id":"14ab1d90","metadata":{"execution":{"iopub.execute_input":"2025-11-27T04:16:17.55152Z","iopub.status.busy":"2025-11-27T04:16:17.551221Z","iopub.status.idle":"2025-11-27T04:16:19.484092Z","shell.execute_reply":"2025-11-27T04:16:19.482523Z"},"papermill":{"duration":1.940653,"end_time":"2025-11-27T04:16:19.485893","exception":false,"start_time":"2025-11-27T04:16:17.54524","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["4291292"]},"execution_count":5,"metadata":{},"output_type":"execute_result"}],"source":["df_user_course_grouped.count()"]},{"cell_type":"code","execution_count":6,"id":"beb9f9f0","metadata":{"execution":{"iopub.execute_input":"2025-11-27T04:16:19.498111Z","iopub.status.busy":"2025-11-27T04:16:19.497893Z","iopub.status.idle":"2025-11-27T04:16:22.067642Z","shell.execute_reply":"2025-11-27T04:16:22.066622Z"},"papermill":{"duration":2.577753,"end_time":"2025-11-27T04:16:22.069502","exception":false,"start_time":"2025-11-27T04:16:19.491749","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["                                                                                \r"]},{"name":"stdout","output_type":"stream","text":["+---------+----------+-----------+----------+----------+----------+----------------+----------------+----------------+----------------+--------------------+--------------------+----------+\n","|course_id|   user_id|enroll_date|start_date|  end_date|remain_day|phase_1_end_date|phase_2_end_date|phase_3_end_date|phase_4_end_date|          video_list|total_video_duration|num_videos|\n","+---------+----------+-----------+----------+----------+----------+----------------+----------------+----------------+----------------+--------------------+--------------------+----------+\n","| C_883345|U_13901179| 2020-09-22|2020-08-24|2020-12-31|       101|      2020-10-17|      2020-11-11|      2020-12-06|      2020-12-31|[V_1007135, V_100...|  254558.64200000005|      1006|\n","| C_883345|U_13901218| 2020-02-04|2020-01-20|2020-07-31|       179|      2020-03-19|      2020-05-03|      2020-06-17|      2020-07-31|[V_1007135, V_100...|  254558.64200000005|      1006|\n","| C_676937|U_13901233| 2020-03-30|2020-02-12|2020-07-31|       124|      2020-04-30|      2020-05-31|      2020-07-01|      2020-07-31|[V_69198, V_69199...|            29257.56|        84|\n","| C_883345|U_13902540| 2020-02-18|2020-01-20|2020-07-31|       165|      2020-03-30|      2020-05-10|      2020-06-20|      2020-07-31|[V_1007135, V_100...|  254558.64200000005|      1006|\n","| C_883345|U_13902805| 2019-11-07|2019-09-12|2020-01-12|        67|      2019-11-23|      2019-12-10|      2019-12-27|      2020-01-12|[V_1007135, V_100...|  254558.64200000005|      1006|\n","| C_676937|U_13903252| 2020-10-13|2020-09-01|2020-12-31|        80|      2020-11-02|      2020-11-22|      2020-12-12|      2020-12-31|[V_69198, V_69199...|            29257.56|        84|\n","| C_883345|U_13903252| 2020-11-03|2020-08-24|2020-12-31|        59|      2020-11-17|      2020-12-02|      2020-12-17|      2020-12-31|[V_1007135, V_100...|  254558.64200000005|      1006|\n","| C_676937|U_13903261| 2020-10-12|2020-09-01|2020-12-31|        81|      2020-11-01|      2020-11-21|      2020-12-11|      2020-12-31|[V_69198, V_69199...|            29257.56|        84|\n","| C_883345|U_13904125| 2020-02-03|2020-01-20|2020-07-31|       180|      2020-03-19|      2020-05-03|      2020-06-17|      2020-07-31|[V_1007135, V_100...|  254558.64200000005|      1006|\n","| C_676937|U_13905299| 2019-12-04|2019-11-18|2020-01-12|        40|      2019-12-14|      2019-12-24|      2020-01-03|      2020-01-12|[V_69198, V_69199...|            29257.56|        84|\n","| C_883345|U_13905299| 2020-01-30|2020-01-20|2020-07-31|       184|      2020-03-16|      2020-05-01|      2020-06-16|      2020-07-31|[V_1007135, V_100...|  254558.64200000005|      1006|\n","| C_883345|U_13906267| 2019-12-05|2019-09-12|2020-01-12|        39|      2019-12-14|      2019-12-24|      2020-01-03|      2020-01-12|[V_1007135, V_100...|  254558.64200000005|      1006|\n","| C_948409|U_13906438| 2020-02-21|2019-08-01|2020-03-31|        40|      2020-03-02|      2020-03-12|      2020-03-22|      2020-03-31|[V_1483636, V_148...|  12534.189999999999|        55|\n","| C_883345|U_13906492| 2020-02-08|2020-01-20|2020-07-31|       175|      2020-03-22|      2020-05-05|      2020-06-18|      2020-07-31|[V_1007135, V_100...|  254558.64200000005|      1006|\n","| C_883345|U_13907503| 2020-02-16|2020-01-20|2020-07-31|       167|      2020-03-28|      2020-05-09|      2020-06-20|      2020-07-31|[V_1007135, V_100...|  254558.64200000005|      1006|\n","| C_676937|U_13907508| 2020-02-14|2020-02-12|2020-07-31|       169|      2020-03-27|      2020-05-08|      2020-06-19|      2020-07-31|[V_69198, V_69199...|            29257.56|        84|\n","| C_676937|U_13908320| 2020-02-13|2020-02-12|2020-07-31|       170|      2020-03-26|      2020-05-08|      2020-06-19|      2020-07-31|[V_69198, V_69199...|            29257.56|        84|\n","| C_676937|U_13908930| 2020-04-08|2020-02-12|2020-07-31|       115|      2020-05-06|      2020-06-04|      2020-07-03|      2020-07-31|[V_69198, V_69199...|            29257.56|        84|\n","| C_883345|U_13909674| 2019-11-17|2019-09-12|2020-01-12|        57|      2019-12-01|      2019-12-15|      2019-12-29|      2020-01-12|[V_1007135, V_100...|  254558.64200000005|      1006|\n","| C_883345|U_13909965| 2019-11-08|2019-09-12|2020-01-12|        66|      2019-11-24|      2019-12-11|      2019-12-27|      2020-01-12|[V_1007135, V_100...|  254558.64200000005|      1006|\n","+---------+----------+-----------+----------+----------+----------+----------------+----------------+----------------+----------------+--------------------+--------------------+----------+\n","only showing top 20 rows\n","\n"]}],"source":["df_user_course_grouped.show()"]},{"cell_type":"code","execution_count":7,"id":"9597438c","metadata":{"execution":{"iopub.execute_input":"2025-11-27T04:16:22.082587Z","iopub.status.busy":"2025-11-27T04:16:22.081498Z","iopub.status.idle":"2025-11-27T04:16:22.303306Z","shell.execute_reply":"2025-11-27T04:16:22.302877Z"},"papermill":{"duration":0.229652,"end_time":"2025-11-27T04:16:22.305177","exception":false,"start_time":"2025-11-27T04:16:22.075525","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["1977141"]},"execution_count":7,"metadata":{},"output_type":"execute_result"}],"source":["df_user_video_final.count()"]},{"cell_type":"code","execution_count":8,"id":"1c46a361","metadata":{"execution":{"iopub.execute_input":"2025-11-27T04:16:22.312781Z","iopub.status.busy":"2025-11-27T04:16:22.312542Z","iopub.status.idle":"2025-11-27T04:16:22.82797Z","shell.execute_reply":"2025-11-27T04:16:22.827186Z"},"papermill":{"duration":0.520998,"end_time":"2025-11-27T04:16:22.82964","exception":false,"start_time":"2025-11-27T04:16:22.308642","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["+----------+---------+---------------+------------------+------------------+----------------------+-----------------+-------------------+-----------------+-------------+------------------+---------------------+----------+---------------+-------------+\n","|   user_id| video_id|max_watch_point|       rewind_time| fast_forward_time|first_local_start_time|actual_watch_time|weighted_watch_time|interaction_count|session_count|speed_change_count|distinct_speeds_count|start_hour|start_dayofweek|average_speed|\n","+----------+---------+---------------+------------------+------------------+----------------------+-----------------+-------------------+-----------------+-------------+------------------+---------------------+----------+---------------+-------------+\n","|U_10001587|V_6012902|         1097.4|               0.0|             140.0|   2020-08-19 10:34:56|            950.5|             475.25|                2|            1|                 0|                    1|        10|              4|          2.0|\n","| U_1000290|V_6280776|         1042.3|               0.0|              94.9|   2020-10-03 01:23:10|            942.5|              942.5|                4|            1|                 0|                    1|         1|              7|          1.0|\n","|U_10008027|V_6059415|          706.9|               0.0|               0.0|   2020-08-19 13:08:52|            702.0|              702.0|                1|            1|                 0|                    1|        13|              4|          1.0|\n","|U_10011100|V_6043053|         2779.8|29.000000000000004|210.79999999999998|   2020-08-19 15:13:37|           2595.0|             2595.0|              519|            1|                 0|                    1|        15|              4|          1.0|\n","|U_10012383|V_6026303|         3401.7|               0.0|            3362.0|   2020-08-18 16:11:32|             35.0|               35.0|                2|            1|                 0|                    1|        16|              3|          1.0|\n","|U_10012383|V_6043053|         3128.0|            2585.5|            1139.0|   2020-08-18 01:16:05|           1950.0|             1950.0|               41|            1|                 0|                    1|         1|              3|          1.0|\n","|U_10012383|V_6043065|         9623.6|             180.7| 4678.200000000001|   2020-08-18 13:39:57|           5121.3|             5121.3|               23|            1|                 0|                    1|        13|              3|          1.0|\n","|U_10013620|V_7386537|         2399.9|               0.0|             279.6|   2020-09-24 02:44:48|           1250.5|             625.25|                4|            1|                 0|                    1|         2|              5|          2.0|\n","|U_10013633|V_7386534|          128.3|               0.0|               0.0|   2020-09-21 08:56:12|            120.0|               60.0|                1|            1|                 0|                    1|         8|              2|          2.0|\n","|U_10013633|V_7386535|         5328.7|               0.0|            2820.1|   2020-09-21 09:32:58|           2499.4|             1249.7|                5|            1|                 0|                    1|         9|              2|          2.0|\n","|U_10016535|V_7386537|          950.0|               0.0|              65.0|   2020-09-21 10:38:19|            880.1|              880.1|                3|            1|                 0|                    1|        10|              2|          1.0|\n","|U_10017195|V_7386535|         2054.9|               0.0|             125.0|   2020-09-21 10:21:09|           1925.0|             1925.0|                5|            1|                 0|                    1|        10|              2|          1.0|\n","|U_10018490|V_7386534|         3238.2|               0.0|             311.4|   2020-09-25 06:19:15|           2920.1|            1460.05|                7|            1|                 0|                    1|         6|              6|          2.0|\n","|U_10018910|V_7386537|         2746.5|               0.0|             129.5|   2020-09-22 08:57:25|            567.6|              283.8|                2|            1|                 0|                    1|         8|              3|          2.0|\n","| U_1001999|V_6354955|         1545.0|               0.0|            1451.0|   2020-10-23 01:27:06|             89.0|               89.0|                3|            1|                 0|                    1|         1|              6|          1.0|\n","|  U_100203|V_6328750|          198.0|               0.0|             116.0|   2020-09-22 13:23:07|             77.0|              51.33|                3|            1|                 0|                    1|        13|              3|          1.5|\n","| U_1002389|V_6202616|          423.0|               0.0|              12.0|   2020-09-23 16:07:55|            407.0|              407.0|                3|            1|                 0|                    1|        16|              4|          1.0|\n","|U_10024550|V_7386534|         2654.7|               0.0|             660.0|   2020-10-04 07:13:09|            895.0|              895.0|                8|            1|                 0|                    1|         7|              1|          1.0|\n","|U_10026106|V_7386534|          665.6|               0.0|             119.8|   2020-10-03 07:28:39|            540.0|              270.0|                2|            1|                 0|                    1|         7|              7|          2.0|\n","|U_10026204|V_7386532|         3216.2|               5.1|             100.0|   2020-09-29 16:14:53|            575.1|             545.05|                5|            1|                 1|                    2|        16|              3|         1.06|\n","+----------+---------+---------------+------------------+------------------+----------------------+-----------------+-------------------+-----------------+-------------+------------------+---------------------+----------+---------------+-------------+\n","only showing top 20 rows\n","\n"]}],"source":["df_user_video_final.show()"]},{"cell_type":"code","execution_count":9,"id":"e51b8959","metadata":{"execution":{"iopub.execute_input":"2025-11-27T04:16:22.843334Z","iopub.status.busy":"2025-11-27T04:16:22.843096Z","iopub.status.idle":"2025-11-27T04:16:22.962527Z","shell.execute_reply":"2025-11-27T04:16:22.961707Z"},"papermill":{"duration":0.127525,"end_time":"2025-11-27T04:16:22.964049","exception":false,"start_time":"2025-11-27T04:16:22.836524","status":"completed"},"tags":[]},"outputs":[],"source":["from pyspark.sql import functions as F\n","\n","# --- Bước 1: Unpivot (Trải phẳng) các cột Phase End Date ---\n","# Biến mỗi dòng User-Course thành 4 dòng (Phase 1, 2, 3, 4)\n","# Mỗi dòng sẽ có một 'phase_deadline' riêng biệt lấy từ các cột phase_X_end_date\n","\n","# Giả sử trong df_user_course_grouped có các cột thống kê tổng (num_videos, total_video_duration, video_list...)\n","# Nếu chưa có video_list ở đây, bạn cần đảm bảo nó tồn tại để lọc video thuộc khóa học\n","\n","uc_expanded = df_user_course_grouped.select(\n","    \"user_id\", \n","    \"course_id\", \n","    \"enroll_date\", \n","    \"video_list\",              # Cần cột này để check video thuộc khóa học\n","    \"num_videos\",              # Giữ lại để tính ratio sau này (đỡ phải join lại)\n","    \"total_video_duration\",    # Giữ lại để tính ratio sau này\n","    F.expr(\"stack(4, 1, phase_1_end_date, 2, phase_2_end_date, 3, phase_3_end_date, 4, phase_4_end_date) as (phase, phase_deadline)\")\n",")\n","\n","# Lúc này uc_expanded sẽ có dạng:\n","# user_id | course_id | phase | phase_deadline | ...các cột khác"]},{"cell_type":"code","execution_count":10,"id":"c051bdab","metadata":{"execution":{"iopub.execute_input":"2025-11-27T04:16:22.972377Z","iopub.status.busy":"2025-11-27T04:16:22.972164Z","iopub.status.idle":"2025-11-27T04:16:23.215215Z","shell.execute_reply":"2025-11-27T04:16:23.214424Z"},"papermill":{"duration":0.248892,"end_time":"2025-11-27T04:16:23.216657","exception":false,"start_time":"2025-11-27T04:16:22.967765","status":"completed"},"tags":[]},"outputs":[],"source":["# --- Bước 2: Join với bảng Video và Aggregate ---\n","\n","# Chuyển đổi timestamp sang date để so sánh chính xác với phase_deadline\n","uv_prep = df_user_video_final.withColumn(\"event_date\", F.to_date(\"first_local_start_time\"))\n","\n","# Thực hiện Join\n","# Logic: \n","# 1. Cùng User\n","# 2. Video nằm trong list video của khóa học\n","# 3. Ngày xem <= Deadline của Phase (Đây là logic thay thế cho days_since_enroll <= 13, 27...)\n","# 4. Ngày xem >= Ngày đăng ký (Chỉ lấy dữ liệu sau khi enroll)\n","\n","joined_df = uc_expanded.alias(\"uc\").join(\n","    uv_prep.alias(\"uv\"),\n","    on=[\n","        F.col(\"uc.user_id\") == F.col(\"uv.user_id\"),\n","        F.array_contains(F.col(\"uc.video_list\"), F.col(\"uv.video_id\")),\n","        F.col(\"uv.event_date\") <= F.col(\"uc.phase_deadline\"), \n","        F.col(\"uv.event_date\") >= F.col(\"uc.enroll_date\")\n","    ],\n","    how=\"left\" # Giữ lại row phase ngay cả khi user chưa xem gì\n",")\n","\n","# Aggregate dữ liệu\n","cumulative_agg = joined_df.groupBy(\n","    \"uc.user_id\", \"uc.course_id\", \"uc.phase\"\n",").agg(\n","    # Các cột mẫu số (denominator) giữ nguyên từ bảng UC (dùng max hoặc first đều được vì giống nhau trong group)\n","    F.first(\"uc.num_videos\").alias(\"num_videos\"),\n","    F.first(\"uc.total_video_duration\").alias(\"total_video_duration\"),\n","    \n","    # Các cột tử số (numerator) tính toán từ bảng UV\n","    F.countDistinct(\"uv.video_id\").alias(\"num_watched_in_course\"),\n","    F.sum(\"uv.actual_watch_time\").alias(\"sum_actual_watch_time\"),\n","    F.sum(\"uv.weighted_watch_time\").alias(\"sum_weighted_watch_time\"),\n","    F.sum(\"uv.interaction_count\").alias(\"sum_interactions\"),\n","    F.sum(\"uv.session_count\").alias(\"sum_sessions\"),\n","    F.sum(\"uv.speed_change_count\").alias(\"sum_speed_changes\"),\n","    F.sum(\"uv.fast_forward_time\").alias(\"sum_fast_forward\"),\n","    F.sum(\"uv.rewind_time\").alias(\"sum_rewind\"),\n","    \n","    F.max(\"uv.max_watch_point\").alias(\"max_watch_point_agg\"),\n","    F.min(\"uv.first_local_start_time\").alias(\"first_watch_time\"),\n","    F.first(\"uc.enroll_date\").alias(\"enroll_date_ref\") # Lấy lại để tính days_until_first_watch\n",")\n","\n","# Fill NA = 0 cho các cột tính tổng (trường hợp Left Join không có dữ liệu)\n","fill_zeros_cols = [\n","    \"num_watched_in_course\", \"sum_actual_watch_time\", \"sum_weighted_watch_time\",\n","    \"sum_interactions\", \"sum_sessions\", \"sum_speed_changes\",\n","    \"sum_fast_forward\", \"sum_rewind\", \"max_watch_point_agg\"\n","]\n","cumulative_agg = cumulative_agg.fillna(0, subset=fill_zeros_cols)"]},{"cell_type":"code","execution_count":11,"id":"b3a09b86","metadata":{"execution":{"iopub.execute_input":"2025-11-27T04:16:23.23188Z","iopub.status.busy":"2025-11-27T04:16:23.231531Z","iopub.status.idle":"2025-11-27T04:18:43.646088Z","shell.execute_reply":"2025-11-27T04:18:43.64532Z"},"papermill":{"duration":140.425701,"end_time":"2025-11-27T04:18:43.648775","exception":false,"start_time":"2025-11-27T04:16:23.223074","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["[Stage 14:=====================================================>  (64 + 3) / 67]\r"]},{"name":"stdout","output_type":"stream","text":["+---------+---------+-----+--------------+------------------+--------------------+----------------------+------------------+-------------------------+----------------------+----------------+---------------------+----------------------+\n","|  user_id|course_id|phase|coverage_ratio|course_watch_ratio|weighted_watch_ratio|interactions_per_video|sessions_per_video|speed_changes_per_session|fast_forward_per_watch|rewind_per_watch|max_watch_point_ratio|days_until_first_watch|\n","+---------+---------+-----+--------------+------------------+--------------------+----------------------+------------------+-------------------------+----------------------+----------------+---------------------+----------------------+\n","|U_1000000| C_707031|    1|           0.0|               0.0|                 0.0|                   0.0|               0.0|                      0.0|                   0.0|             0.0|                  0.0|                    -1|\n","|U_1000000| C_707031|    2|           0.0|               0.0|                 0.0|                   0.0|               0.0|                      0.0|                   0.0|             0.0|                  0.0|                    -1|\n","|U_1000000| C_707031|    3|           0.0|               0.0|                 0.0|                   0.0|               0.0|                      0.0|                   0.0|             0.0|                  0.0|                    -1|\n","|U_1000000| C_707031|    4|           0.0|               0.0|                 0.0|                   0.0|               0.0|                      0.0|                   0.0|             0.0|                  0.0|                    -1|\n","|  U_10001| C_697236|    1|           0.0|               0.0|                 0.0|                   0.0|               0.0|                      0.0|                   0.0|             0.0|                  0.0|                    -1|\n","|  U_10001| C_697236|    2|           0.0|               0.0|                 0.0|                   0.0|               0.0|                      0.0|                   0.0|             0.0|                  0.0|                    -1|\n","|  U_10001| C_697236|    3|           0.0|               0.0|                 0.0|                   0.0|               0.0|                      0.0|                   0.0|             0.0|                  0.0|                    -1|\n","|  U_10001| C_697236|    4|           0.0|               0.0|                 0.0|                   0.0|               0.0|                      0.0|                   0.0|             0.0|                  0.0|                    -1|\n","|U_1000129| C_799796|    1|           0.0|               0.0|                 0.0|                   0.0|               0.0|                      0.0|                   0.0|             0.0|                  0.0|                    -1|\n","|U_1000129| C_799796|    2|           0.0|               0.0|                 0.0|                   0.0|               0.0|                      0.0|                   0.0|             0.0|                  0.0|                    -1|\n","|U_1000129| C_799796|    3|           0.0|               0.0|                 0.0|                   0.0|               0.0|                      0.0|                   0.0|             0.0|                  0.0|                    -1|\n","|U_1000129| C_799796|    4|           0.0|               0.0|                 0.0|                   0.0|               0.0|                      0.0|                   0.0|             0.0|                  0.0|                    -1|\n","|U_1000290| C_697293|    1|           0.0|               0.0|                 0.0|                   0.0|               0.0|                      0.0|                   0.0|             0.0|                  0.0|                    -1|\n","|U_1000290| C_697293|    2|           0.0|               0.0|                 0.0|                   0.0|               0.0|                      0.0|                   0.0|             0.0|                  0.0|                    -1|\n","|U_1000290| C_697293|    3|           0.0|               0.0|                 0.0|                   0.0|               0.0|                      0.0|                   0.0|             0.0|                  0.0|                    -1|\n","|U_1000290| C_697293|    4|           0.0|               0.0|                 0.0|                   0.0|               0.0|                      0.0|                   0.0|             0.0|                  0.0|                    -1|\n","|U_1000342| C_696968|    1|           0.0|               0.0|                 0.0|                   0.0|               0.0|                      0.0|                   0.0|             0.0|                  0.0|                    -1|\n","|U_1000342| C_696968|    2|           0.0|               0.0|                 0.0|                   0.0|               0.0|                      0.0|                   0.0|             0.0|                  0.0|                    -1|\n","|U_1000342| C_696968|    3|           0.0|               0.0|                 0.0|                   0.0|               0.0|                      0.0|                   0.0|             0.0|                  0.0|                    -1|\n","|U_1000342| C_696968|    4|           0.0|               0.0|                 0.0|                   0.0|               0.0|                      0.0|                   0.0|             0.0|                  0.0|                    -1|\n","+---------+---------+-----+--------------+------------------+--------------------+----------------------+------------------+-------------------------+----------------------+----------------+---------------------+----------------------+\n","only showing top 20 rows\n","\n","root\n"," |-- user_id: string (nullable = true)\n"," |-- course_id: string (nullable = true)\n"," |-- phase: integer (nullable = true)\n"," |-- coverage_ratio: double (nullable = true)\n"," |-- course_watch_ratio: double (nullable = true)\n"," |-- weighted_watch_ratio: double (nullable = true)\n"," |-- interactions_per_video: double (nullable = true)\n"," |-- sessions_per_video: double (nullable = true)\n"," |-- speed_changes_per_session: double (nullable = true)\n"," |-- fast_forward_per_watch: double (nullable = true)\n"," |-- rewind_per_watch: double (nullable = true)\n"," |-- max_watch_point_ratio: double (nullable = true)\n"," |-- days_until_first_watch: integer (nullable = false)\n","\n"]},{"name":"stderr","output_type":"stream","text":["                                                                                \r"]}],"source":["# --- Bước 3: Tính các chỉ số Ratio ---\n","\n","# Hàm hỗ trợ để tránh lỗi chia cho 0\n","nz = lambda c: F.when((F.col(c).isNull()) | (F.col(c) == 0), F.lit(None)).otherwise(F.col(c))\n","\n","result_df = cumulative_agg.withColumn(\"coverage_ratio\", F.col(\"num_watched_in_course\") / nz(\"num_videos\")) \\\n","    .withColumn(\"course_watch_ratio\", F.col(\"sum_actual_watch_time\") / nz(\"total_video_duration\")) \\\n","    .withColumn(\"weighted_watch_ratio\", F.col(\"sum_weighted_watch_time\") / nz(\"total_video_duration\")) \\\n","    .withColumn(\"interactions_per_video\", F.col(\"sum_interactions\") / nz(\"num_watched_in_course\")) \\\n","    .withColumn(\"sessions_per_video\", F.col(\"sum_sessions\") / nz(\"num_watched_in_course\")) \\\n","    .withColumn(\"speed_changes_per_session\", F.col(\"sum_speed_changes\") / nz(\"sum_sessions\")) \\\n","    .withColumn(\"fast_forward_per_watch\", F.col(\"sum_fast_forward\") / nz(\"sum_actual_watch_time\")) \\\n","    .withColumn(\"rewind_per_watch\", F.col(\"sum_rewind\") / nz(\"sum_actual_watch_time\")) \\\n","    .withColumn(\"max_watch_point_ratio\", F.col(\"max_watch_point_agg\") / nz(\"total_video_duration\")) \\\n","    .withColumn(\"days_until_first_watch\", F.datediff(F.col(\"first_watch_time\"), F.col(\"enroll_date_ref\")))\n","\n","# Fill 0 cho các ratio nếu chia cho null/0\n","metric_cols = [\n","    \"coverage_ratio\", \"course_watch_ratio\", \"weighted_watch_ratio\", \n","    \"interactions_per_video\", \"sessions_per_video\", \"speed_changes_per_session\",\n","    \"fast_forward_per_watch\", \"rewind_per_watch\", \"max_watch_point_ratio\"\n","]\n","result_df = result_df.fillna(0, subset=metric_cols)\n","\n","# --- Bước 4: Làm tròn và Select cột cuối cùng ---\n","from pyspark.sql.types import DoubleType, FloatType\n","\n","final_cols = [\"user_id\", \"course_id\", \"phase\"] + metric_cols + [\"days_until_first_watch\"]\n","\n","# Làm tròn số thực\n","exprs = []\n","for col_name in final_cols:\n","    # Nếu là cột nằm trong list metric cần làm tròn\n","    if col_name in metric_cols:\n","        exprs.append(F.round(F.col(col_name), 2).alias(col_name))\n","    else:\n","        exprs.append(F.col(col_name))\n","\n","result_final = result_df.select(*exprs).orderBy(\"user_id\", \"course_id\", \"phase\")\n","\n","# Xử lý days_until_first_watch: nếu null (chưa xem) thì để -1\n","result_final = result_final.fillna({\"days_until_first_watch\": -1})\n","\n","result_final.show(20)\n","result_final.printSchema()"]},{"cell_type":"code","execution_count":12,"id":"5ff98068","metadata":{"execution":{"iopub.execute_input":"2025-11-27T04:18:43.669603Z","iopub.status.busy":"2025-11-27T04:18:43.669327Z","iopub.status.idle":"2025-11-27T04:23:38.081968Z","shell.execute_reply":"2025-11-27T04:23:38.081048Z"},"papermill":{"duration":294.425075,"end_time":"2025-11-27T04:23:38.084281","exception":false,"start_time":"2025-11-27T04:18:43.659206","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["[Stage 26:===========================================>              (3 + 1) / 4]\r"]},{"name":"stdout","output_type":"stream","text":["Saved Successfully\n"]},{"name":"stderr","output_type":"stream","text":["                                                                                \r"]}],"source":["result_final_output = 'result_final.csv'\n","result_final.write.mode(\"overwrite\").option(\"header\", \"true\").csv(result_final_output)\n","print(\"Saved Successfully\")"]},{"cell_type":"code","execution_count":13,"id":"b53d5ef9","metadata":{"execution":{"iopub.execute_input":"2025-11-27T04:23:38.109871Z","iopub.status.busy":"2025-11-27T04:23:38.109303Z","iopub.status.idle":"2025-11-27T04:23:55.483575Z","shell.execute_reply":"2025-11-27T04:23:55.482733Z"},"papermill":{"duration":17.385835,"end_time":"2025-11-27T04:23:55.484807","exception":false,"start_time":"2025-11-27T04:23:38.098972","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["✅ Đã nén file thành result_final.parquet.zip\n"]}],"source":["import shutil\n","\n","input_dir = \"/kaggle/working/result_final.csv\"\n","output_zip = \"/kaggle/working/result_final.csv\"\n","\n","shutil.make_archive(output_zip, 'zip', input_dir)\n","print(\"✅ Đã nén file thành result_final.parquet.zip\")"]},{"cell_type":"code","execution_count":14,"id":"c7ac9441","metadata":{"execution":{"iopub.execute_input":"2025-11-27T04:23:55.505771Z","iopub.status.busy":"2025-11-27T04:23:55.505477Z","iopub.status.idle":"2025-11-27T04:23:55.508568Z","shell.execute_reply":"2025-11-27T04:23:55.508026Z"},"papermill":{"duration":0.015001,"end_time":"2025-11-27T04:23:55.509791","exception":false,"start_time":"2025-11-27T04:23:55.49479","status":"completed"},"tags":[]},"outputs":[],"source":["# # rm -rf /kaggle/working/*\n","# from IPython.display import FileLink\n","# FileLink('/kaggle/working/df_final_output.parquet')"]}],"metadata":{"kaggle":{"accelerator":"gpu","dataSources":[{"datasetId":8588806,"sourceId":13526698,"sourceType":"datasetVersion"},{"datasetId":8848379,"sourceId":13888737,"sourceType":"datasetVersion"}],"dockerImageVersionId":31153,"isGpuEnabled":true,"isInternetEnabled":true,"language":"python","sourceType":"notebook"},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.11.13"},"papermill":{"default_parameters":{},"duration":476.479249,"end_time":"2025-11-27T04:23:58.138112","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2025-11-27T04:16:01.658863","version":"2.6.0"}},"nbformat":4,"nbformat_minor":5}