{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/trakiet/dualeo?scriptVersionId=274675767\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"code","execution_count":1,"id":"9b24cdd4","metadata":{"_cell_guid":"b1076dfc-b9ad-4769-8c92-a6c4dae69d19","_uuid":"8f2839f25d086af736a60e9eeb907d3b93b6e0e5","execution":{"iopub.execute_input":"2025-11-09T03:59:29.406016Z","iopub.status.busy":"2025-11-09T03:59:29.405771Z","iopub.status.idle":"2025-11-09T03:59:30.844343Z","shell.execute_reply":"2025-11-09T03:59:30.84355Z"},"papermill":{"duration":1.444788,"end_time":"2025-11-09T03:59:30.845988","exception":false,"start_time":"2025-11-09T03:59:29.4012","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["/kaggle/input/comment-phase/part-00000-076c1ea4-ce42-4ee1-8c15-f23a1d5949ae-c000.csv\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00064-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00010-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00088-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00165-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00178-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00149-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00190-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00153-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00180-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00091-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00191-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00120-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00046-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00141-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00054-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00108-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00016-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00101-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00145-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00040-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00110-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00020-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00003-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00066-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00134-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00006-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00199-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00061-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00151-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00130-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00026-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00024-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00033-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00019-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00164-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00116-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00123-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00182-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00169-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00189-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00111-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00152-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00171-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00080-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00096-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00109-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00125-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00098-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00135-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00139-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00044-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00119-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00177-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00181-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00148-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00115-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00079-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00168-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00155-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00193-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00114-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00053-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00077-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00027-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00104-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00034-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00198-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00124-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00131-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00126-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00039-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00063-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00002-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00147-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00103-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00076-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00157-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00081-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00107-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00042-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00173-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00047-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00021-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00090-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00014-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00060-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00015-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00162-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00073-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00187-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00158-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00144-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00118-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00137-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00099-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00195-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00117-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00032-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00138-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00094-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00051-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00065-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00023-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00097-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00025-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00089-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00062-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00121-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00113-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00128-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00167-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00005-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00133-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00170-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00045-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00084-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00102-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00004-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00001-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00007-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00174-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00067-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00093-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00069-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00011-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00049-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00179-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00150-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00197-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00129-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00078-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00068-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00146-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00176-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00058-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00018-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00194-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00106-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00188-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00143-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00127-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00142-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00071-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00132-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00070-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00028-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00056-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00000-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00037-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00029-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00184-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00086-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00186-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00154-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00048-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00059-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00022-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00100-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00192-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00196-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00175-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00136-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00156-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00095-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00092-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00160-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00112-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00041-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00085-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00055-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00050-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00140-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00183-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00031-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00172-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00163-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00122-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00057-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00012-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00043-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00075-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00159-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00008-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00013-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00083-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00166-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00009-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00036-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00017-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00038-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00030-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00035-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00185-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00161-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/_SUCCESS\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00072-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00082-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00105-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00087-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00074-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_with_stats_fixed.parquet/part-00052-4e5200ed-6360-4cc9-a1c4-2899d2e588e6-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_user_video_final.parquet/part-00004-be584545-8204-4005-9a41-89ee3dea23bc-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_user_video_final.parquet/part-00002-be584545-8204-4005-9a41-89ee3dea23bc-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_user_video_final.parquet/part-00007-be584545-8204-4005-9a41-89ee3dea23bc-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_user_video_final.parquet/part-00003-be584545-8204-4005-9a41-89ee3dea23bc-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_user_video_final.parquet/part-00006-be584545-8204-4005-9a41-89ee3dea23bc-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_user_video_final.parquet/part-00000-be584545-8204-4005-9a41-89ee3dea23bc-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_user_video_final.parquet/part-00005-be584545-8204-4005-9a41-89ee3dea23bc-c000.snappy.parquet\n","/kaggle/input/user-video-final/df_user_video_final.parquet/_SUCCESS\n","/kaggle/input/user-video-final/df_user_video_final.parquet/part-00001-be584545-8204-4005-9a41-89ee3dea23bc-c000.snappy.parquet\n","/kaggle/input/user-course-group/part-00003-7b731a72-3ce3-43af-8433-f0f3d3d0ee05-c000.snappy.parquet\n","/kaggle/input/user-course-group/.part-00001-7b731a72-3ce3-43af-8433-f0f3d3d0ee05-c000.snappy.parquet.crc\n","/kaggle/input/user-course-group/part-00000-7b731a72-3ce3-43af-8433-f0f3d3d0ee05-c000.snappy.parquet\n","/kaggle/input/user-course-group/.part-00003-7b731a72-3ce3-43af-8433-f0f3d3d0ee05-c000.snappy.parquet.crc\n","/kaggle/input/user-course-group/part-00001-7b731a72-3ce3-43af-8433-f0f3d3d0ee05-c000.snappy.parquet\n","/kaggle/input/user-course-group/._SUCCESS.crc\n","/kaggle/input/user-course-group/.part-00000-7b731a72-3ce3-43af-8433-f0f3d3d0ee05-c000.snappy.parquet.crc\n","/kaggle/input/user-course-group/part-00002-7b731a72-3ce3-43af-8433-f0f3d3d0ee05-c000.snappy.parquet\n","/kaggle/input/user-course-group/.part-00002-7b731a72-3ce3-43af-8433-f0f3d3d0ee05-c000.snappy.parquet.crc\n","/kaggle/input/user-course-group/_SUCCESS\n"]}],"source":["# This Python 3 environment comes with many helpful analytics libraries installed\n","# It is defined by the kaggle/python Docker image: https://github.com/kaggle/docker-python\n","# For example, here's several helpful packages to load\n","\n","import numpy as np # linear algebra\n","import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)\n","\n","# Input data files are available in the read-only \"../input/\" directory\n","# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n","\n","import os\n","for dirname, _, filenames in os.walk('/kaggle/input'):\n","    for filename in filenames:\n","        print(os.path.join(dirname, filename))\n","\n","# You can write up to 20GB to the current directory (/kaggle/working/) that gets preserved as output when you create a version using \"Save & Run All\" \n","# You can also write temporary files to /kaggle/temp/, but they won't be saved outside of the current session"]},{"cell_type":"code","execution_count":2,"id":"449ee77d","metadata":{"execution":{"iopub.execute_input":"2025-11-09T03:59:30.853904Z","iopub.status.busy":"2025-11-09T03:59:30.853557Z","iopub.status.idle":"2025-11-09T03:59:30.856743Z","shell.execute_reply":"2025-11-09T03:59:30.856223Z"},"papermill":{"duration":0.008017,"end_time":"2025-11-09T03:59:30.857856","exception":false,"start_time":"2025-11-09T03:59:30.849839","status":"completed"},"tags":[]},"outputs":[],"source":["df_user_video_final_path = '/kaggle/input/user-video-final/df_user_video_final.parquet'\n","df_user_course_grouped_path = '/kaggle/input/user-course-group'"]},{"cell_type":"code","execution_count":3,"id":"d8138255","metadata":{"execution":{"iopub.execute_input":"2025-11-09T03:59:30.864558Z","iopub.status.busy":"2025-11-09T03:59:30.864363Z","iopub.status.idle":"2025-11-09T03:59:37.795395Z","shell.execute_reply":"2025-11-09T03:59:37.794626Z"},"papermill":{"duration":6.936071,"end_time":"2025-11-09T03:59:37.796974","exception":false,"start_time":"2025-11-09T03:59:30.860903","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["Setting default log level to \"WARN\".\n","To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).\n","25/11/09 03:59:36 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\n"]}],"source":["import pyspark\n","from pyspark.sql import SparkSession\n","import warnings\n","from pyspark.sql.types import *\n","from pyspark.sql import functions as F\n","from pyspark.sql.types import IntegerType\n","import seaborn as sns\n","import matplotlib.pyplot as plt\n","from os import truncate\n","from pyspark.sql.functions import explode, col, sum, from_unixtime, hour, dayofweek, count, round, when, isnull, split, avg, regexp_replace\n","warnings.filterwarnings(\"ignore\")\n","\n","spark = SparkSession.builder \\\n","  .appName(\"reply_user_video_analysis\") \\\n","  .master(\"local[*]\") \\\n","  .config(\"spark.some.config.option\", \"some-value\") \\\n","  .getOrCreate()"]},{"cell_type":"code","execution_count":4,"id":"12a62c45","metadata":{"execution":{"iopub.execute_input":"2025-11-09T03:59:37.805689Z","iopub.status.busy":"2025-11-09T03:59:37.804629Z","iopub.status.idle":"2025-11-09T03:59:41.88314Z","shell.execute_reply":"2025-11-09T03:59:41.882288Z"},"papermill":{"duration":4.084354,"end_time":"2025-11-09T03:59:41.884889","exception":false,"start_time":"2025-11-09T03:59:37.800535","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["                                                                                \r"]}],"source":["# Đọc toàn bộ folder (tự động load tất cả part-*.parquet)\n","df_user_video_final = spark.read.parquet(df_user_video_final_path)\n","# df_with_stats_fixed = spark.read.parquet(df_with_stats_fixed_path)\n","df_user_course_grouped = spark.read.parquet(df_user_course_grouped_path)"]},{"cell_type":"code","execution_count":5,"id":"ae1de283","metadata":{"execution":{"iopub.execute_input":"2025-11-09T03:59:41.892875Z","iopub.status.busy":"2025-11-09T03:59:41.892513Z","iopub.status.idle":"2025-11-09T03:59:43.715587Z","shell.execute_reply":"2025-11-09T03:59:43.714826Z"},"papermill":{"duration":1.828904,"end_time":"2025-11-09T03:59:43.717458","exception":false,"start_time":"2025-11-09T03:59:41.888554","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["3405404"]},"execution_count":5,"metadata":{},"output_type":"execute_result"}],"source":["df_user_course_grouped.count()"]},{"cell_type":"code","execution_count":6,"id":"9d1dbfd4","metadata":{"execution":{"iopub.execute_input":"2025-11-09T03:59:43.730667Z","iopub.status.busy":"2025-11-09T03:59:43.73039Z","iopub.status.idle":"2025-11-09T03:59:46.320764Z","shell.execute_reply":"2025-11-09T03:59:46.31995Z"},"papermill":{"duration":2.598645,"end_time":"2025-11-09T03:59:46.322473","exception":false,"start_time":"2025-11-09T03:59:43.723828","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["                                                                                \r"]},{"name":"stdout","output_type":"stream","text":["+---------+----------+-----------+----------+----------+----------+--------------------+--------------------+----------+\n","|course_id|   user_id|enroll_date|start_date|  end_date|remain_day|          video_list|total_video_duration|num_videos|\n","+---------+----------+-----------+----------+----------+----------+--------------------+--------------------+----------+\n","| C_676937|U_15287250| 2020-05-07|2020-02-12|2020-07-31|        85|[V_69198, V_69199...|            29257.56|        84|\n","| C_883345|U_15287757| 2020-02-11|2020-01-20|2020-07-31|       171|[V_1007135, V_100...|  254558.64200000005|      1006|\n","| C_883345|U_15287761| 2020-02-19|2020-01-20|2020-07-31|       163|[V_1007135, V_100...|  254558.64200000005|      1006|\n","| C_883345|U_15287911| 2020-01-21|2020-01-20|2020-07-31|       192|[V_1007135, V_100...|  254558.64200000005|      1006|\n","| C_948409|U_15288689| 2020-02-03|2019-08-01|2020-03-31|        57|[V_1483636, V_148...|  12534.189999999999|        55|\n","| C_883345|U_15288813| 2020-04-11|2020-01-20|2020-07-31|       111|[V_1007135, V_100...|  254558.64200000005|      1006|\n","| C_676937|U_15288979| 2020-03-13|2020-02-12|2020-07-31|       140|[V_69198, V_69199...|            29257.56|        84|\n","| C_676937|U_15289040| 2020-04-02|2020-02-12|2020-07-31|       120|[V_69198, V_69199...|            29257.56|        84|\n","| C_883345|U_15289040| 2020-10-12|2020-08-24|2020-12-31|        80|[V_1007135, V_100...|  254558.64200000005|      1006|\n","| C_883345|U_15289085| 2020-02-10|2020-01-20|2020-07-31|       172|[V_1007135, V_100...|  254558.64200000005|      1006|\n","| C_883345|U_15289090| 2020-04-17|2020-01-20|2020-07-31|       105|[V_1007135, V_100...|  254558.64200000005|      1006|\n","| C_883345|U_15289226| 2020-01-31|2020-01-20|2020-07-31|       182|[V_1007135, V_100...|  254558.64200000005|      1006|\n","| C_948409|U_15289798| 2020-04-29|2020-04-03|2020-07-30|        92|[V_1483636, V_148...|  12534.189999999999|        55|\n","| C_883345|U_15290896| 2020-05-08|2020-01-20|2020-07-31|        84|[V_1007135, V_100...|  254558.64200000005|      1006|\n","| C_676937|U_15291850| 2020-03-16|2020-02-12|2020-07-31|       137|[V_69198, V_69199...|            29257.56|        84|\n","| C_883345|U_15291850| 2020-04-17|2020-01-20|2020-07-31|       105|[V_1007135, V_100...|  254558.64200000005|      1006|\n","| C_948409|U_15291986| 2020-05-31|2020-04-03|2020-07-30|        60|[V_1483636, V_148...|  12534.189999999999|        55|\n","| C_948409|U_15292006| 2020-06-02|2020-04-03|2020-07-30|        58|[V_1483636, V_148...|  12534.189999999999|        55|\n","| C_948409|U_15292020| 2020-05-31|2020-04-03|2020-07-30|        60|[V_1483636, V_148...|  12534.189999999999|        55|\n","| C_948409|U_15292104| 2020-05-31|2020-04-03|2020-07-30|        60|[V_1483636, V_148...|  12534.189999999999|        55|\n","+---------+----------+-----------+----------+----------+----------+--------------------+--------------------+----------+\n","only showing top 20 rows\n","\n"]}],"source":["df_user_course_grouped.show()"]},{"cell_type":"code","execution_count":7,"id":"acc89f17","metadata":{"execution":{"iopub.execute_input":"2025-11-09T03:59:46.331056Z","iopub.status.busy":"2025-11-09T03:59:46.330436Z","iopub.status.idle":"2025-11-09T03:59:46.630501Z","shell.execute_reply":"2025-11-09T03:59:46.629625Z"},"papermill":{"duration":0.305659,"end_time":"2025-11-09T03:59:46.631889","exception":false,"start_time":"2025-11-09T03:59:46.32623","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["1977141"]},"execution_count":7,"metadata":{},"output_type":"execute_result"}],"source":["df_user_video_final.count()"]},{"cell_type":"code","execution_count":8,"id":"5c6bfe01","metadata":{"execution":{"iopub.execute_input":"2025-11-09T03:59:46.640602Z","iopub.status.busy":"2025-11-09T03:59:46.639978Z","iopub.status.idle":"2025-11-09T03:59:47.088386Z","shell.execute_reply":"2025-11-09T03:59:47.086698Z"},"papermill":{"duration":0.453984,"end_time":"2025-11-09T03:59:47.089675","exception":false,"start_time":"2025-11-09T03:59:46.635691","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["+----------+---------+---------------+------------------+------------------+----------------------+-----------------+-------------------+-----------------+-------------+------------------+---------------------+----------+---------------+-------------+\n","|   user_id| video_id|max_watch_point|       rewind_time| fast_forward_time|first_local_start_time|actual_watch_time|weighted_watch_time|interaction_count|session_count|speed_change_count|distinct_speeds_count|start_hour|start_dayofweek|average_speed|\n","+----------+---------+---------------+------------------+------------------+----------------------+-----------------+-------------------+-----------------+-------------+------------------+---------------------+----------+---------------+-------------+\n","|U_10001587|V_6012902|         1097.4|               0.0|             140.0|   2020-08-19 10:34:56|            950.5|             475.25|                2|            1|                 0|                    1|        10|              4|          2.0|\n","| U_1000290|V_6280776|         1042.3|               0.0|              94.9|   2020-10-03 01:23:10|            942.5|              942.5|                4|            1|                 0|                    1|         1|              7|          1.0|\n","|U_10008027|V_6059415|          706.9|               0.0|               0.0|   2020-08-19 13:08:52|            702.0|              702.0|                1|            1|                 0|                    1|        13|              4|          1.0|\n","|U_10011100|V_6043053|         2779.8|29.000000000000004|210.79999999999998|   2020-08-19 15:13:37|           2595.0|             2595.0|              519|            1|                 0|                    1|        15|              4|          1.0|\n","|U_10012383|V_6026303|         3401.7|               0.0|            3362.0|   2020-08-18 16:11:32|             35.0|               35.0|                2|            1|                 0|                    1|        16|              3|          1.0|\n","|U_10012383|V_6043053|         3128.0|            2585.5|            1139.0|   2020-08-18 01:16:05|           1950.0|             1950.0|               41|            1|                 0|                    1|         1|              3|          1.0|\n","|U_10012383|V_6043065|         9623.6|             180.7| 4678.200000000001|   2020-08-18 13:39:57|           5121.3|             5121.3|               23|            1|                 0|                    1|        13|              3|          1.0|\n","|U_10013620|V_7386537|         2399.9|               0.0|             279.6|   2020-09-24 02:44:48|           1250.5|             625.25|                4|            1|                 0|                    1|         2|              5|          2.0|\n","|U_10013633|V_7386534|          128.3|               0.0|               0.0|   2020-09-21 08:56:12|            120.0|               60.0|                1|            1|                 0|                    1|         8|              2|          2.0|\n","|U_10013633|V_7386535|         5328.7|               0.0|            2820.1|   2020-09-21 09:32:58|           2499.4|             1249.7|                5|            1|                 0|                    1|         9|              2|          2.0|\n","|U_10016535|V_7386537|          950.0|               0.0|              65.0|   2020-09-21 10:38:19|            880.1|              880.1|                3|            1|                 0|                    1|        10|              2|          1.0|\n","|U_10017195|V_7386535|         2054.9|               0.0|             125.0|   2020-09-21 10:21:09|           1925.0|             1925.0|                5|            1|                 0|                    1|        10|              2|          1.0|\n","|U_10018490|V_7386534|         3238.2|               0.0|             311.4|   2020-09-25 06:19:15|           2920.1|            1460.05|                7|            1|                 0|                    1|         6|              6|          2.0|\n","|U_10018910|V_7386537|         2746.5|               0.0|             129.5|   2020-09-22 08:57:25|            567.6|              283.8|                2|            1|                 0|                    1|         8|              3|          2.0|\n","| U_1001999|V_6354955|         1545.0|               0.0|            1451.0|   2020-10-23 01:27:06|             89.0|               89.0|                3|            1|                 0|                    1|         1|              6|          1.0|\n","|  U_100203|V_6328750|          198.0|               0.0|             116.0|   2020-09-22 13:23:07|             77.0|              51.33|                3|            1|                 0|                    1|        13|              3|          1.5|\n","| U_1002389|V_6202616|          423.0|               0.0|              12.0|   2020-09-23 16:07:55|            407.0|              407.0|                3|            1|                 0|                    1|        16|              4|          1.0|\n","|U_10024550|V_7386534|         2654.7|               0.0|             660.0|   2020-10-04 07:13:09|            895.0|              895.0|                8|            1|                 0|                    1|         7|              1|          1.0|\n","|U_10026106|V_7386534|          665.6|               0.0|             119.8|   2020-10-03 07:28:39|            540.0|              270.0|                2|            1|                 0|                    1|         7|              7|          2.0|\n","|U_10026204|V_7386532|         3216.2|               5.1|             100.0|   2020-09-29 16:14:53|            575.1|             545.05|                5|            1|                 1|                    2|        16|              3|         1.06|\n","+----------+---------+---------------+------------------+------------------+----------------------+-----------------+-------------------+-----------------+-------------+------------------+---------------------+----------+---------------+-------------+\n","only showing top 20 rows\n","\n"]}],"source":["df_user_video_final.show()"]},{"cell_type":"code","execution_count":9,"id":"1340a70e","metadata":{"execution":{"iopub.execute_input":"2025-11-09T03:59:47.098831Z","iopub.status.busy":"2025-11-09T03:59:47.098586Z","iopub.status.idle":"2025-11-09T03:59:48.11429Z","shell.execute_reply":"2025-11-09T03:59:48.113037Z"},"papermill":{"duration":1.0223,"end_time":"2025-11-09T03:59:48.116093","exception":false,"start_time":"2025-11-09T03:59:47.093793","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["root\n"," |-- user_id: string (nullable = true)\n"," |-- course_id: string (nullable = true)\n"," |-- phase: long (nullable = true)\n"," |-- avg_speed_in_course: double (nullable = false)\n"," |-- coverage_ratio: double (nullable = false)\n"," |-- course_watch_ratio: double (nullable = false)\n"," |-- weighted_watch_ratio: double (nullable = false)\n"," |-- interactions_per_video: double (nullable = false)\n"," |-- sessions_per_video: double (nullable = false)\n"," |-- speed_changes_per_session: double (nullable = false)\n"," |-- fast_forward_per_watch: double (nullable = false)\n"," |-- rewind_per_watch: double (nullable = false)\n"," |-- max_watch_point_ratio: double (nullable = false)\n","\n"]}],"source":["from pyspark.sql import functions as F\n","from pyspark.sql.window import Window\n","\n","# --- Bước 0: Định nghĩa các mốc Phase (Cumulative) ---\n","# Chúng ta sẽ định nghĩa mốc ngày TỐI ĐA cho mỗi phase\n","phase_data = [\n","    # (phase, max_day_in_phase)\n","    (1, 13),  # Phase 1: Bao gồm các event từ ngày 0 -> 13\n","    (2, 27),  # Phase 2: Bao gồm các event từ ngày 0 -> 27\n","    (3, 41),  # Phase 3: Bao gồm các event từ ngày 0 -> 41\n","    (4, 55)   # Phase 4: Bao gồm các event từ ngày 0 -> 55\n","]\n","phase_df = spark.createDataFrame(phase_data, [\"phase\", \"max_day_in_phase\"])\n","\n","# --- Bước 1: Lấy tất cả event và tính 'days_since_enroll' ---\n","# Join uv (events) và uc (enrollment) để tính ngày tương đối\n","uv = df_user_video_final.alias(\"uv\")\n","uc = df_user_course_grouped.alias(\"uc\")\n","\n","uv_with_phase_info = (\n","    uv.join(\n","        # Chỉ lấy các cột cần thiết từ uc để join và tính toán\n","        uc.select(\"user_id\", \"course_id\", \"enroll_date\", \"video_list\"),\n","        (uv.user_id == uc.user_id) & F.array_contains(uc.video_list, uv.video_id),\n","        \"inner\"\n","    )\n","    # Tính số ngày kể từ lúc đăng ký (có thể là số âm nếu xem trước)\n","    .withColumn(\"days_since_enroll\", F.datediff(F.col(\"uv.first_local_start_time\"), F.col(\"uc.enroll_date\")))\n","    # Lọc các event trong 56 ngày đầu tiên (0 -> 55)\n","    .filter(F.col(\"days_since_enroll\").between(0, 55))\n","    .select(\n","        F.col(\"uc.course_id\"),\n","        F.col(\"uc.user_id\"),\n","        F.col(\"uv.video_id\"),\n","        F.col(\"uv.rewind_time\"),\n","        F.col(\"uv.fast_forward_time\"),\n","        F.col(\"uv.first_local_start_time\"),\n","        F.col(\"uv.actual_watch_time\"),\n","        F.col(\"uv.weighted_watch_time\"),\n","        F.col(\"uv.interaction_count\"),\n","        F.col(\"uv.session_count\"),\n","        F.col(\"uv.speed_change_count\"),\n","        F.col(\"uv.average_speed\"),\n","        F.col(\"uv.max_watch_point\"),\n","        F.col(\"days_since_enroll\")\n","    )\n","    .repartition(\"user_id\", \"course_id\") # Tối ưu cho join ở bước sau\n",")\n","\n","# --- Bước 2: Tạo bảng \"Grid\" (user, course, phase) ---\n","# Đây là bảng \"khung\" chứa 4 dòng (mỗi phase 1 dòng)\n","# cho mỗi cặp (user_id, course_id)\n","base_grid = (\n","    uc.select(\"user_id\", \"course_id\")\n","    .distinct()\n","    .crossJoin(phase_df)\n",")\n","\n","# --- Bước 3: Join \"Grid\" với \"Events\" và Gộp (Cumulative) ---\n","# Đây là bước then chốt:\n","# Ta join grid (g) với events (e)\n","# với điều kiện event xảy ra TRƯỚC HOẶC BẰNG mốc 'max_day_in_phase'\n","g = base_grid.alias(\"g\")\n","e = uv_with_phase_info.alias(\"e\")\n","\n","cumulative_agg = (\n","    g.join(\n","        e,\n","        (g.user_id == e.user_id) &\n","        (g.course_id == e.course_id) &\n","        (e.days_since_enroll <= g.max_day_in_phase), # Logic CỘNG DỒN nằm ở đây\n","        \"left\" # Dùng LEFT JOIN để giữ lại các phase 0 có event\n","    )\n","    .groupBy(\"g.user_id\", \"g.course_id\", \"g.phase\")\n","    .agg(\n","        # Tất cả các hàm gộp (SUM, COUNT, MAX, MIN, AVG)\n","        # giờ đều là CỘNG DỒN TỰ ĐỘNG\n","        F.countDistinct(\"e.video_id\").alias(\"num_watched_in_course\"),\n","\n","        F.sum(\"e.actual_watch_time\").alias(\"sum_actual_watch_time_in_course\"),\n","        F.sum(\"e.weighted_watch_time\").alias(\"sum_weighted_watch_time_in_course\"),\n","        F.sum(\"e.interaction_count\").alias(\"sum_interactions_in_course\"),\n","        F.sum(\"e.session_count\").alias(\"sum_sessions_in_course\"),\n","        F.sum(\"e.speed_change_count\").alias(\"sum_speed_changes_in_course\"),\n","        F.avg(\"e.average_speed\").alias(\"avg_speed_in_course\"), # Avg cộng dồn\n","        F.max(\"e.max_watch_point\").alias(\"max_watch_point_in_course\"), # Max cộng dồn\n","\n","        F.sum(\"e.fast_forward_time\").alias(\"sum_fast_forward_time_in_course\"),\n","        F.sum(\"e.rewind_time\").alias(\"sum_rewind_time_in_course\"),\n","\n","        # Lấy mốc thời gian xem ĐẦU TIÊN (sẽ giữ nguyên qua các phase)\n","        F.min(\"e.first_local_start_time\").alias(\"first_local_start_time\"),\n","    )\n",")\n","\n","# --- Bước 4: Join lại vào 'uc' (đã nhân 4 phase) để lấy thông tin gốc ---\n","# (num_videos, total_video_duration,...)\n","\n","# Tạo bảng uc_with_phases (mỗi user-course có 4 dòng, 1 cho mỗi phase)\n","uc_with_phases = uc.crossJoin(phase_df.select(\"phase\"))\n","\n","res0 = uc_with_phases.join(\n","    cumulative_agg,\n","    on=[\"user_id\", \"course_id\", \"phase\"],\n","    how=\"left\" # Giữ lại 7M * 4 dòng gốc\n",")\n","\n","# --- Bước 5: FillNA cho các cột aggregate (RẤT QUAN TRỌNG) ---\n","# Cần fillna = 0 cho các cột SUM/COUNT/MAX TRƯỚC KHI tính ratio\n","# (cho các user/phase chưa có hoạt động)\n","agg_cols_to_fill = [\n","    \"num_watched_in_course\", \"sum_actual_watch_time_in_course\",\n","    \"sum_weighted_watch_time_in_course\", \"sum_interactions_in_course\",\n","    \"sum_sessions_in_course\", \"sum_speed_changes_in_course\",\n","    \"avg_speed_in_course\", \"max_watch_point_in_course\",\n","    \"sum_fast_forward_time_in_course\", \"sum_rewind_time_in_course\"\n","]\n","res0_filled = res0.fillna(0, subset=agg_cols_to_fill)\n","\n","# --- Bước 6: Tính RATIOs (Giống code gốc của bạn) ---\n","nz = lambda col: F.when(F.col(col).isNull() | (F.col(col) == 0), F.lit(None)).otherwise(F.col(col))\n","\n","result_with_phases = (\n","    res0_filled # Dùng bảng đã fillna\n","    .withColumn(\"coverage_ratio\", F.col(\"num_watched_in_course\") / nz(\"num_videos\"))\n","    .withColumn(\"course_watch_ratio\", F.col(\"sum_actual_watch_time_in_course\") / nz(\"total_video_duration\"))\n","    .withColumn(\"weighted_watch_ratio\", F.col(\"sum_weighted_watch_time_in_course\") / nz(\"total_video_duration\"))\n","    .withColumn(\"interactions_per_video\", F.col(\"sum_interactions_in_course\") / nz(\"num_watched_in_course\"))\n","    .withColumn(\"sessions_per_video\", F.col(\"sum_sessions_in_course\") / nz(\"num_watched_in_course\"))\n","    .withColumn(\"speed_changes_per_session\", F.col(\"sum_speed_changes_in_course\") / nz(\"sum_sessions_in_course\"))\n","    .withColumn(\"fast_forward_per_watch\", F.col(\"sum_fast_forward_time_in_course\") / nz(\"sum_actual_watch_time_in_course\"))\n","    .withColumn(\"rewind_per_watch\", F.col(\"sum_rewind_time_in_course\") / nz(\"sum_actual_watch_time_in_course\"))\n","    .withColumn(\"max_watch_point_ratio\", F.col(\"max_watch_point_in_course\") / nz(\"total_video_duration\"))\n","    .fillna(0, subset=[ # fillna cho chính các ratio (nếu mẫu số = 0)\n","        \"coverage_ratio\",\"course_watch_ratio\",\"weighted_watch_ratio\",\n","        \"interactions_per_video\",\"sessions_per_video\",\"speed_changes_per_session\",\n","        \"fast_forward_per_watch\",\"rewind_per_watch\",\"max_watch_point_ratio\"\n","    ])\n","    .drop(\n","        # Xoá các cột SUM trung gian\n","        \"sum_actual_watch_time_in_course\",\"sum_weighted_watch_time_in_course\",\n","        \"sum_interactions_in_course\",\"sum_sessions_in_course\",\n","        \"sum_speed_changes_in_course\",\"sum_fast_forward_time_in_course\",\n","        \"sum_rewind_time_in_course\",\"max_watch_point_in_course\",\n","        # Xoá các cột gốc (denominator)\n","        \"total_video_duration\",\"num_videos\",\"num_watched_in_course\", \"video_list\"\n","    )\n",")\n","\n","# --- Bước 7: Tính 'since_day_enroll' (Đã sửa lại) ---\n","# Tính số ngày từ lúc đăng ký (enroll_date) đến lúc XEM ĐẦU TIÊN (first_local_start_time)\n","# Dùng datediff thay vì F.day() để tính toán cho chính xác\n","result_final = (\n","    result_with_phases\n","    .withColumn(\n","        \"since_day_enroll\",\n","        F.datediff(F.col(\"first_local_start_time\"), F.col(\"enroll_date\"))\n","    )\n","    .drop(\"first_local_start_time\", \"enroll_date\", \"start_date\", \"end_date\", \"remain_day\")\n","    # Fill -1 (hoặc số đặc biệt) cho những ai CHƯA TỪNG XEM\n","    # (vì 0 có nghĩa là xem ngay trong ngày đăng ký)\n","    .fillna({\"since_day_enroll\": -1})\n","    .drop(\"since_day_enroll\")\n",")\n","\n","# `result_final` bây giờ là DataFrame cuối cùng của bạn\n","# Nó sẽ có (số_dòng_uc * 4) dòng\n","result_final.printSchema()"]},{"cell_type":"code","execution_count":10,"id":"7a76ed07","metadata":{"execution":{"iopub.execute_input":"2025-11-09T03:59:48.125877Z","iopub.status.busy":"2025-11-09T03:59:48.125632Z","iopub.status.idle":"2025-11-09T03:59:53.499916Z","shell.execute_reply":"2025-11-09T03:59:53.499132Z"},"papermill":{"duration":5.382352,"end_time":"2025-11-09T03:59:53.503445","exception":false,"start_time":"2025-11-09T03:59:48.121093","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["                                                                                \r"]},{"data":{"text/plain":["13621616"]},"execution_count":10,"metadata":{},"output_type":"execute_result"}],"source":["result_final.count()"]},{"cell_type":"code","execution_count":11,"id":"91675881","metadata":{"execution":{"iopub.execute_input":"2025-11-09T03:59:53.517949Z","iopub.status.busy":"2025-11-09T03:59:53.517629Z","iopub.status.idle":"2025-11-09T03:59:53.594994Z","shell.execute_reply":"2025-11-09T03:59:53.594168Z"},"papermill":{"duration":0.08645,"end_time":"2025-11-09T03:59:53.596827","exception":false,"start_time":"2025-11-09T03:59:53.510377","status":"completed"},"tags":[]},"outputs":[],"source":["from pyspark.sql import functions as F\n","from pyspark.sql.types import DoubleType, FloatType, DecimalType, DateType, TimestampType, IntegerType, LongType\n","\n","# 1) Làm tròn round(2) cho toàn bộ cột số thực (double/float/decimal)\n","EXCLUDE_COLS = {\n","    \"user_id\", \"course_id\",  # khóa\n","    \"since_day_enroll\",      # số nguyên (để nguyên)\n","    # nếu còn các cột ngày/ts từ uc như start_date/end_date/certificate... thì cũng không round\n","}\n","\n","exprs = []\n","for field in result_final.schema.fields:\n","    name = field.name\n","    dt = field.dataType\n","    if name in EXCLUDE_COLS or isinstance(dt, (DateType, TimestampType, IntegerType, LongType)):\n","        exprs.append(F.col(name))\n","    elif isinstance(dt, (DoubleType, FloatType, DecimalType)):\n","        exprs.append(F.round(F.col(name), 2).alias(name))\n","    else:\n","        exprs.append(F.col(name))\n","\n","result_final = result_final.select(*exprs)\n"]},{"cell_type":"code","execution_count":12,"id":"41d8a57d","metadata":{"execution":{"iopub.execute_input":"2025-11-09T03:59:53.610965Z","iopub.status.busy":"2025-11-09T03:59:53.61075Z","iopub.status.idle":"2025-11-09T04:01:53.680003Z","shell.execute_reply":"2025-11-09T04:01:53.676262Z"},"papermill":{"duration":120.079856,"end_time":"2025-11-09T04:01:53.684033","exception":false,"start_time":"2025-11-09T03:59:53.604177","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["--- Hiển thị toàn bộ DataFrame (result_final) ---\n","--- Sắp xếp theo: user_id, course_id, phase ---\n"]},{"name":"stderr","output_type":"stream","text":["25/11/09 04:00:53 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:53 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:53 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:53 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:53 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:53 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:53 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:53 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:53 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:53 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:53 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:53 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:53 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:53 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:53 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:53 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:53 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:53 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:53 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:53 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:53 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:53 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:53 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:53 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:56 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:56 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:56 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:56 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:56 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:56 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:57 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:57 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:57 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:57 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:57 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:57 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:57 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:57 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:57 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:57 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:57 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:57 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:57 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:57 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:57 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:57 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:57 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:57 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:57 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:57 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:57 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:57 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:57 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:57 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:58 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:58 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:58 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:58 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:58 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:58 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:58 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:58 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:58 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:58 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:58 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:58 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:58 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:58 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:58 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:58 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:58 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:58 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:59 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:59 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:59 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:59 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:59 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:00:59 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:01 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:01 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:01 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:01 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:01 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:01 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:01 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:01 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:01 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:01 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:01 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:01 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:01 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:01 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:01 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:01 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:01 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:01 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:01 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:01 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:01 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:01 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:01 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:01 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:03 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:03 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:03 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:05 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:05 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:05 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:05 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:05 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:05 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:05 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:05 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:05 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:05 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:05 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:05 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:05 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:05 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:05 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:05 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:06 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:06 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:06 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:06 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:07 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:07 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:07 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:07 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:07 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:07 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:07 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:07 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:07 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:07 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:07 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:07 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:08 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:08 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:08 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:08 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:08 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:08 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:08 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:08 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:08 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:08 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:08 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:08 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:08 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:08 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:08 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:08 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:09 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:09 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:09 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:09 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:10 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:10 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:10 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:10 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:10 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:10 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:10 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:10 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:10 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:10 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:10 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:10 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:11 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:11 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:11 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:11 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:11 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:11 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:11 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:11 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:11 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:11 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:11 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:11 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:11 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:11 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:11 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:11 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:12 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:12 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:12 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:12 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:12 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:12 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:12 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:12 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:13 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:13 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:13 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:13 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:13 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:13 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:13 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:13 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:15 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:15 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:15 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:15 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:15 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:15 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:16 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:16 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:16 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:16 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:16 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:16 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:17 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:17 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:17 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:17 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:17 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:17 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:17 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:17 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:18 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:18 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:18 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:18 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:19 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:19 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:19 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:19 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:19 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:19 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:19 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:19 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:20 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:20 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:20 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:20 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:21 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:21 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:21 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:21 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:21 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:21 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:22 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:01:22 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","[Stage 34:>                                                         (0 + 4) / 7]\r"]},{"name":"stdout","output_type":"stream","text":["[129.284s][warning][gc,alloc] Executor task launch worker for task 3.0 in stage 34.0 (TID 90): Retried waiting for GCLocker too often allocating 1048578 words\n"]},{"name":"stderr","output_type":"stream","text":["25/11/09 04:01:42 WARN TaskMemoryManager: Failed to allocate a page (8388608 bytes), try again.\n","[Stage 34:=========================================>                (5 + 2) / 7]\r"]},{"name":"stdout","output_type":"stream","text":["+----------+---------+-----+-------------------+--------------+------------------+--------------------+----------------------+------------------+-------------------------+----------------------+----------------+---------------------+\n","|   user_id|course_id|phase|avg_speed_in_course|coverage_ratio|course_watch_ratio|weighted_watch_ratio|interactions_per_video|sessions_per_video|speed_changes_per_session|fast_forward_per_watch|rewind_per_watch|max_watch_point_ratio|\n","+----------+---------+-----+-------------------+--------------+------------------+--------------------+----------------------+------------------+-------------------------+----------------------+----------------+---------------------+\n","|  U_100838|C_1903985|    3|                1.0|          0.02|               0.0|                 0.0|                   1.0|               1.0|                      0.0|                   0.0|             0.0|                  0.0|\n","|  U_100838|C_1903985|    4|                1.0|          0.02|               0.0|                 0.0|                   1.0|               1.0|                      0.0|                   0.0|             0.0|                  0.0|\n","|U_10099726|C_1428968|    1|                2.0|          0.02|               0.0|                 0.0|                   1.0|               1.0|                      0.0|                   0.0|             0.0|                  0.0|\n","|U_10099726|C_1428968|    2|                2.0|          0.02|               0.0|                 0.0|                   1.0|               1.0|                      0.0|                   0.0|             0.0|                  0.0|\n","|U_10099726|C_1428968|    3|                2.0|          0.02|               0.0|                 0.0|                   1.0|               1.0|                      0.0|                   0.0|             0.0|                  0.0|\n","|U_10099726|C_1428968|    4|                2.0|          0.02|               0.0|                 0.0|                   1.0|               1.0|                      0.0|                   0.0|             0.0|                  0.0|\n","|U_10138438| C_756646|    1|                1.0|          0.01|               0.0|                 0.0|                   2.0|               1.0|                      0.0|                 13.01|             0.0|                 0.03|\n","|U_10138438| C_756646|    2|               1.03|          0.04|              0.02|                0.02|                  3.33|               1.0|                     0.33|                  3.39|            0.03|                 0.03|\n","|U_10138438| C_756646|    3|               1.03|          0.04|              0.02|                0.02|                  3.33|               1.0|                     0.33|                  3.39|            0.03|                 0.03|\n","|U_10138438| C_756646|    4|               1.03|          0.04|              0.02|                0.02|                  3.33|               1.0|                     0.33|                  3.39|            0.03|                 0.03|\n","|U_10138447| C_756646|    2|                1.0|          0.01|              0.01|                0.01|                   3.0|               1.0|                      0.0|                  0.05|             0.0|                 0.03|\n","|U_10138447| C_756646|    3|                1.0|          0.01|              0.01|                0.01|                   3.0|               1.0|                      0.0|                  0.05|             0.0|                 0.03|\n","|U_10138447| C_756646|    4|                1.0|          0.01|              0.01|                0.01|                   3.0|               1.0|                      0.0|                  0.05|             0.0|                 0.03|\n","|U_10138534| C_756646|    1|                1.0|          0.01|               0.0|                 0.0|                   2.0|               1.0|                      0.0|                 54.93|             0.0|                 0.02|\n","|U_10138534| C_756646|    2|                1.0|          0.01|               0.0|                 0.0|                   2.0|               1.0|                      0.0|                 54.93|             0.0|                 0.02|\n","|U_10138534| C_756646|    3|                1.0|          0.01|               0.0|                 0.0|                   2.0|               1.0|                      0.0|                 54.93|             0.0|                 0.02|\n","|U_10138534| C_756646|    4|                1.0|          0.01|               0.0|                 0.0|                   2.0|               1.0|                      0.0|                 54.93|             0.0|                 0.02|\n","|U_10261745| C_746997|    1|                1.0|          0.01|              0.01|                0.01|                   4.0|               1.0|                      0.0|                  0.05|             0.0|                 0.01|\n","|U_10261745| C_746997|    2|                1.0|          0.01|              0.01|                0.01|                   4.0|               1.0|                      0.0|                  0.05|             0.0|                 0.01|\n","|U_10261745| C_746997|    3|                1.0|          0.01|              0.01|                0.01|                   4.0|               1.0|                      0.0|                  0.05|             0.0|                 0.01|\n","+----------+---------+-----+-------------------+--------------+------------------+--------------------+----------------------+------------------+-------------------------+----------------------+----------------+---------------------+\n","only showing top 20 rows\n","\n"]},{"name":"stderr","output_type":"stream","text":["                                                                                \r"]}],"source":["from pyspark.sql import functions as F\n","\n","print(\"--- Hiển thị toàn bộ DataFrame (result_final) ---\")\n","print(\"--- Sắp xếp theo: user_id, course_id, phase ---\")\n","\n","# Sắp xếp DataFrame theo 3 cột\n","sorted_df = result_final.orderBy(\"user_id\", \"course_id\", \"phase\")\n","sorted_df = sorted_df.filter(F.col(\"coverage_ratio\") > 0)\n","# Hiển thị kết quả (mặc định là 20 dòng đầu tiên)\n","# Dùng show(n) nếu bạn muốn xem nhiều dòng hơn, ví dụ: show(100)\n","sorted_df.show()\n","\n","# Nếu bạn muốn xem TOÀN BỘ (có thể rất chậm và tốn bộ nhớ):\n","# sorted_df.show(result_final.count(), truncate=False)"]},{"cell_type":"code","execution_count":13,"id":"5c6b9595","metadata":{"execution":{"iopub.execute_input":"2025-11-09T04:01:53.725542Z","iopub.status.busy":"2025-11-09T04:01:53.724636Z","iopub.status.idle":"2025-11-09T04:04:10.836029Z","shell.execute_reply":"2025-11-09T04:04:10.832151Z"},"papermill":{"duration":137.130752,"end_time":"2025-11-09T04:04:10.839263","exception":false,"start_time":"2025-11-09T04:01:53.708511","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["25/11/09 04:02:48 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:48 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:48 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:48 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:48 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:48 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:48 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:48 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:48 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:48 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:48 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:48 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:48 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:48 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:48 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:48 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:48 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:48 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:48 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:48 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:48 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:48 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:48 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:48 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:48 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:48 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:48 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:49 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:49 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:49 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:49 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:49 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:49 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:49 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:49 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:49 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:49 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:49 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:49 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:49 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:49 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:49 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:49 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:49 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:49 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:49 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:49 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:49 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:49 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:49 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:49 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:51 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:51 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:51 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:51 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:51 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:51 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:51 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:51 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:51 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:51 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:51 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:51 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:51 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:51 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:51 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:51 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:51 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:51 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:51 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:51 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:51 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:51 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:51 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:51 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:52 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:52 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:52 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:52 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:52 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:52 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:52 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:52 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:52 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:52 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:52 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:52 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:52 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:52 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:52 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:52 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:52 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:52 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:52 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:52 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:52 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:52 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:52 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:52 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:54 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:54 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:54 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:54 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:54 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:54 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:54 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:54 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:54 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:54 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:54 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:54 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:54 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:54 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:54 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:54 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:54 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:54 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:54 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:54 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:54 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:54 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:54 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:54 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:55 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:57 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:57 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:57 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:58 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:58 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:58 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:58 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:59 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:59 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:59 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:59 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:59 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:59 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:59 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:59 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:59 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:59 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:59 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:02:59 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:00 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:01 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:01 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:01 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:01 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:02 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:02 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:02 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:02 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:02 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:02 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:02 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:02 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:02 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:02 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:02 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:02 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:02 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:02 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:02 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:02 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:03 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:03 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:03 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:03 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:03 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:03 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:03 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:03 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:03 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:03 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:03 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:03 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:04 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:04 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:04 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:04 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:04 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:04 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:04 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:04 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:04 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:04 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:04 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:04 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:05 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:05 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:05 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:05 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:05 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:05 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:05 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:05 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:06 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:06 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:06 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:06 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:06 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:06 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:06 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:06 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:06 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:06 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:06 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:06 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:08 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:08 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:08 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:08 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:08 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:08 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:08 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:08 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:09 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:09 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:09 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:09 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:09 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:09 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:10 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:10 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:10 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:10 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:10 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:10 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:11 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:11 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:11 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:11 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:11 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:11 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:12 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:12 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:12 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:12 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:13 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:13 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:13 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:13 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:13 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:14 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:14 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:14 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:14 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:14 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:14 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:14 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:15 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","25/11/09 04:03:15 WARN RowBasedKeyValueBatch: Calling spill() on RowBasedKeyValueBatch. Will not spill but return 0.\n","[Stage 55:=================================================>        (6 + 1) / 7]\r"]},{"name":"stdout","output_type":"stream","text":["Saved Successfully\n"]},{"name":"stderr","output_type":"stream","text":["                                                                                \r"]}],"source":["result_final_output = 'result_final.parquet'\n","result_final.coalesce(10).write.mode(\"overwrite\").option(\"header\", \"true\").parquet(result_final_output)\n","print(\"Saved Successfully\")"]},{"cell_type":"code","execution_count":14,"id":"cfd8eeb4","metadata":{"execution":{"iopub.execute_input":"2025-11-09T04:04:10.892928Z","iopub.status.busy":"2025-11-09T04:04:10.89239Z","iopub.status.idle":"2025-11-09T04:04:15.054875Z","shell.execute_reply":"2025-11-09T04:04:15.054036Z"},"papermill":{"duration":4.186117,"end_time":"2025-11-09T04:04:15.055964","exception":false,"start_time":"2025-11-09T04:04:10.869847","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["✅ Đã nén file thành result_final.parquet.zip\n"]}],"source":["import shutil\n","\n","input_dir = \"/kaggle/working/result_final.parquet\"\n","output_zip = \"/kaggle/working/result_final.parquet\"\n","\n","shutil.make_archive(output_zip, 'zip', input_dir)\n","print(\"✅ Đã nén file thành result_final.parquet.zip\")"]},{"cell_type":"code","execution_count":15,"id":"92250095","metadata":{"execution":{"iopub.execute_input":"2025-11-09T04:04:15.082568Z","iopub.status.busy":"2025-11-09T04:04:15.082091Z","iopub.status.idle":"2025-11-09T04:04:15.085389Z","shell.execute_reply":"2025-11-09T04:04:15.084656Z"},"papermill":{"duration":0.016855,"end_time":"2025-11-09T04:04:15.086457","exception":false,"start_time":"2025-11-09T04:04:15.069602","status":"completed"},"tags":[]},"outputs":[],"source":["# # rm -rf /kaggle/working/*\n","# from IPython.display import FileLink\n","# FileLink('/kaggle/working/df_final_output.parquet')"]}],"metadata":{"kaggle":{"accelerator":"gpu","dataSources":[{"datasetId":8588806,"sourceId":13526698,"sourceType":"datasetVersion"},{"datasetId":8681002,"sourceId":13654864,"sourceType":"datasetVersion"},{"datasetId":8683161,"sourceId":13657726,"sourceType":"datasetVersion"}],"dockerImageVersionId":31153,"isGpuEnabled":true,"isInternetEnabled":true,"language":"python","sourceType":"notebook"},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.11.13"},"papermill":{"default_parameters":{},"duration":291.864484,"end_time":"2025-11-09T04:04:17.715533","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2025-11-09T03:59:25.851049","version":"2.6.0"}},"nbformat":4,"nbformat_minor":5}